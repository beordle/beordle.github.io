title:用来下载整个QQ相册的程序：QQalbumDownloader
date:2010-04-28-10-46
---
<div id="blogDetailDiv" style="font-size:14px;">&#13;
                                                &#13;
                                                <p><b><font class="Apple-style-span" color="#0000FF">它的历史</font></b>我有一个初衷是下载人家QQ相册中的所有照片，但似乎QQ相册没有提供相册批量下载的功能，只能一个一个的点链接，这是非常痛苦的事情啊。因此那天，我编写了它，用来下载人家的照片。有一天人家突然设了密码，我当天研究了Qzone的鉴权。加入了自动鉴权的功能。但是现在我也没心去改善，或是重写它了，就告一段落吧...它是我的，但是人家并不是我的，长再好有什么用，又不是我的。<img src="/qzone/em/e101.gif"/></p><p><b><font class="Apple-style-span" color="#0000FF">它的特性</font></b>纯静态页面解析，不支持带密码的QQ相册下载。</p><p>不过谁要是想下载别人的QQ空间的照片，可以告诉我。我来帮助你。</p><p><span class="Apple-style-span" style="font-family: 'Courier New', monospace; line-height: normal; font-size: 12px; white-space: pre; "><span style="color: rgb(0, 128, 128); ">1</span> <span style="color: rgb(0, 128, 0); ">#</span><span style="color: rgb(0, 128, 0); ">coding: utf-8</span><span style="color: rgb(0, 128, 0); ">
</span><span style="color: rgb(0, 128, 128); "> 2</span> <span style="color: rgb(0, 128, 0); "/><span style="color: rgb(0, 0, 255); ">import</span><span style="color: rgb(0, 0, 0); "> re,urllib2
</span><span style="color: rgb(0, 128, 128); "> 3</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">import</span><span style="color: rgb(0, 0, 0); "> base64
</span><span style="color: rgb(0, 128, 128); "> 4</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">import</span><span style="color: rgb(0, 0, 0); "> urllib,urllib2,sys</span><span style="color: rgb(0, 128, 0); ">#</span><span style="color: rgb(0, 128, 0); ">,cookielib</span><span style="color: rgb(0, 128, 0); ">
</span><span style="color: rgb(0, 128, 128); "> 5</span> <span style="color: rgb(0, 128, 0); "/><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); "> 6</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">def</span><span style="color: rgb(0, 0, 0); "> get_rightquestion():
</span><span style="color: rgb(0, 128, 128); "> 7</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">def</span><span style="color: rgb(0, 0, 0); "> _Callback(a):
</span><span style="color: rgb(0, 128, 128); "> 8</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">return</span><span style="color: rgb(0, 0, 0); "> a[</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">items</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">][0][</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">q</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">].decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); "> 9</span> <span style="color: rgb(0, 0, 0); ">r </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib2.Request(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); "><a href="http://base.qzone.qq.com/cgi-bin/right/get_rightquestion_only.cgi?uin=425315602" target="_blank">http://base.qzone.qq.com/cgi-bin/right/get_rightquestion_only.cgi?uin=425315602</a></span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">10</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">return</span><span style="color: rgb(0, 0, 0); "> eval(urllib2.urlopen(r).read()[:</span><span style="color: rgb(0, 0, 0); ">-</span><span style="color: rgb(0, 0, 0); ">2</span><span style="color: rgb(0, 0, 0); ">])
</span><span style="color: rgb(0, 128, 128); ">11</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">12</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">def</span><span style="color: rgb(0, 0, 0); "> album(QQ):
</span><span style="color: rgb(0, 128, 128); ">13</span> <span style="color: rgb(0, 0, 0); ">list</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">[]
</span><span style="color: rgb(0, 128, 128); ">14</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">def</span><span style="color: rgb(0, 0, 0); "> _albumimage(a):
</span><span style="color: rgb(0, 128, 128); ">15</span> <span style="color: rgb(0, 0, 0); ">list</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">[]
</span><span style="color: rgb(0, 128, 128); ">16</span> <span style="color: rgb(0, 0, 0); ">time</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">1</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">17</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">while</span><span style="color: rgb(0, 0, 0); ">(True):
</span><span style="color: rgb(0, 128, 128); ">18</span> <span style="color: rgb(0, 0, 0); ">mainpage </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib2.urlopen(a).read()
</span><span style="color: rgb(0, 128, 128); ">19</span> <span style="color: rgb(0, 0, 0); ">page</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">re.findall(r</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">src="http://(.*?)"</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">, mainpage, re.S)
</span><span style="color: rgb(0, 128, 128); ">20</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">21</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">if</span><span style="color: rgb(0, 0, 0); "> len(page)</span><span style="color: rgb(0, 0, 0); ">==</span><span style="color: rgb(0, 0, 0); ">0:
</span><span style="color: rgb(0, 128, 128); ">22</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">return</span><span style="color: rgb(0, 0, 0); "> list
</span><span style="color: rgb(0, 128, 128); ">23</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">24</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">for</span><span style="color: rgb(0, 0, 0); "> i </span><span style="color: rgb(0, 0, 255); ">in</span><span style="color: rgb(0, 0, 0); "> page:
</span><span style="color: rgb(0, 128, 128); ">25</span> <span style="color: rgb(0, 0, 0); ">i</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">http://</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">i
</span><span style="color: rgb(0, 128, 128); ">26</span> <span style="color: rgb(0, 0, 0); ">i</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">i.replace(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); "><a href="http://a" target="_blank">http://a</a></span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); "><a href="http://s" target="_blank">http://s</a></span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).replace(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">rurl4_s</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">rurl4_b</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">27</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">print</span><span style="color: rgb(0, 0, 0); "> </span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">发现照片...</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">28</span> <span style="color: rgb(0, 0, 0); ">list.append(i)
</span><span style="color: rgb(0, 128, 128); ">29</span> <span style="color: rgb(0, 0, 0); ">time</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">time</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">1</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">30</span> <span style="color: rgb(0, 0, 0); ">a</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">a.replace(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;pos=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">str(time</span><span style="color: rgb(0, 0, 0); ">-</span><span style="color: rgb(0, 0, 0); ">1</span><span style="color: rgb(0, 0, 0); ">)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;pos=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">str(time)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">31</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 128, 0); ">#</span><span style="color: rgb(0, 128, 0); ">只有2页</span><span style="color: rgb(0, 128, 0); ">
</span><span style="color: rgb(0, 128, 128); ">32</span> <span style="color: rgb(0, 128, 0); "/><span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">for</span><span style="color: rgb(0, 0, 0); "> f </span><span style="color: rgb(0, 0, 255); ">in</span><span style="color: rgb(0, 0, 0); "> range(</span><span style="color: rgb(0, 0, 0); ">1</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(0, 0, 0); ">3</span><span style="color: rgb(0, 0, 0); ">):
</span><span style="color: rgb(0, 128, 128); ">33</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">print</span><span style="color: rgb(0, 0, 0); "> </span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">正在下载第</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">str(f)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">页的相册...</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">34</span> <span style="color: rgb(0, 0, 0); ">main</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); "><a href="http://xa.photo.qq.com/cgi-bin/common/cgi_mini_alist?uin=" target="_blank">http://xa.photo.qq.com/cgi-bin/common/cgi_mini_alist?uin=</a></span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">QQ</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;pos=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">str(f)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">&amp;perpage=6&amp;r=1&amp;idm=imgcache.qq.com</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">35</span> <span style="color: rgb(0, 0, 0); ">mainpage </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib2.urlopen(main).read()
</span><span style="color: rgb(0, 128, 128); ">36</span> <span style="color: rgb(0, 0, 0); ">album</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">re.findall(r</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">&lt;p class="album_name"&gt;&lt;a href="(.*?)"</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">, mainpage, re.S)
</span><span style="color: rgb(0, 128, 128); ">37</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">for</span><span style="color: rgb(0, 0, 0); "> i </span><span style="color: rgb(0, 0, 255); ">in</span><span style="color: rgb(0, 0, 0); "> album:
</span><span style="color: rgb(0, 128, 128); ">38</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">print</span><span style="color: rgb(0, 0, 0); "> </span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">进入相册...</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">39</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">for</span><span style="color: rgb(0, 0, 0); "> j </span><span style="color: rgb(0, 0, 255); ">in</span><span style="color: rgb(0, 0, 0); "> _albumimage(i):
</span><span style="color: rgb(0, 128, 128); ">40</span> <span style="color: rgb(0, 0, 0); "> list.append(j)
</span><span style="color: rgb(0, 128, 128); ">41</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">42</span> <span style="color: rgb(0, 0, 0); "></span><span style="color: rgb(0, 0, 255); ">return</span><span style="color: rgb(0, 0, 0); "> list
</span><span style="color: rgb(0, 128, 128); ">43</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">44</span> <span style="color: rgb(0, 0, 0); ">opener </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib2.build_opener(urllib2.HTTPCookieProcessor())
</span><span style="color: rgb(0, 128, 128); ">45</span> <span style="color: rgb(0, 0, 0); ">urllib2.install_opener(opener)
</span><span style="color: rgb(0, 128, 128); ">46</span> <span style="color: rgb(0, 0, 0); ">answer</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">回答问题</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">47</span> <span style="color: rgb(0, 0, 0); ">question</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); ">get_rightquestion()
</span><span style="color: rgb(0, 128, 128); ">48</span> <span style="color: rgb(0, 0, 0); ">url </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> </span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); "><a href="http://base.qzone.qq.com/cgi-bin/user/cgi_auth" target="_blank">http://base.qzone.qq.com/cgi-bin/user/cgi_auth</a></span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">49</span> <span style="color: rgb(0, 0, 0); ">params </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib.urlencode([
</span><span style="color: rgb(0, 128, 128); ">50</span> <span style="color: rgb(0, 0, 0); ">(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">uin</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">425315602</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">),
</span><span style="color: rgb(0, 128, 128); ">51</span> <span style="color: rgb(0, 0, 0); ">(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">mode</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">,</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">2</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">),
</span><span style="color: rgb(0, 128, 128); ">52</span> <span style="color: rgb(0, 0, 0); ">(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">answer</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">,answer.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)),
</span><span style="color: rgb(0, 128, 128); ">53</span> <span style="color: rgb(0, 0, 0); ">(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">question</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">,question),
</span><span style="color: rgb(0, 128, 128); ">54</span> <span style="color: rgb(0, 0, 0); ">])
</span><span style="color: rgb(0, 128, 128); ">55</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">print</span><span style="color: rgb(0, 0, 0); "> </span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">正在回答</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">question</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">的问题...</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">56</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">assert</span><span style="color: rgb(0, 0, 0); "> question</span><span style="color: rgb(0, 0, 0); ">==</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">我最讨厌什么</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">.decode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">utf-8</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">).encode(</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">gbk</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">),</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">问题已更改,本程序失效.</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">57</span> <span style="color: rgb(0, 0, 0); ">f </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> file(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">photo.htm</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">, </span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">w</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">58</span> <span style="color: rgb(0, 0, 0); ">f.close()
</span><span style="color: rgb(0, 128, 128); ">59</span> <span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">60</span> <span style="color: rgb(0, 0, 0); ">req </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> urllib2.Request(url)
</span><span style="color: rgb(0, 128, 128); ">61</span> <span style="color: rgb(0, 0, 0); ">urllib2.urlopen(req,params).read()
</span><span style="color: rgb(0, 128, 128); ">62</span> <span style="color: rgb(0, 0, 0); ">qq</span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(128, 0, 0); ">425315602</span><span style="color: rgb(128, 0, 0); ">"</span><span style="color: rgb(0, 0, 0); ">
</span><span style="color: rgb(0, 128, 128); ">63</span> <span style="color: rgb(0, 0, 0); "/><span style="color: rgb(0, 0, 255); ">for</span><span style="color: rgb(0, 0, 0); "> i </span><span style="color: rgb(0, 0, 255); ">in</span><span style="color: rgb(0, 0, 0); "> album(qq):
</span><span style="color: rgb(0, 128, 128); ">64</span> <span style="color: rgb(0, 0, 0); ">f </span><span style="color: rgb(0, 0, 0); ">=</span><span style="color: rgb(0, 0, 0); "> file(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">photo.htm</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">, </span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">a</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">65</span> <span style="color: rgb(0, 0, 0); ">f.write(</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">&lt;img src="</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(0, 0, 0); ">i</span><span style="color: rgb(0, 0, 0); ">+</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(128, 0, 0); ">" /&gt;&lt;br&gt;</span><span style="color: rgb(128, 0, 0); ">'</span><span style="color: rgb(0, 0, 0); ">)
</span><span style="color: rgb(0, 128, 128); ">66</span> <span style="color: rgb(0, 0, 0); ">f.close()
</span><span style="color: rgb(0, 128, 128); ">67</span> <span style="color: rgb(0, 0, 0); ">raw_input()
</span><span style="color: rgb(0, 128, 128); ">68</span> </span></p>&#13;
                                                &#13;
                                            </div>&#13;
										